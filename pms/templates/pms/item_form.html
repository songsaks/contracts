{% extends 'pms/base_pms.html' %}

{% block extra_css %}
<style>
    .form-card {
        border: none;
        border-radius: var(--radius-xl);
        box-shadow: var(--shadow-md);
        overflow: hidden;
    }

    .form-card .card-header {
        background: linear-gradient(135deg, #4f46e5, #6366f1);
        color: white;
        padding: 1rem 1.5rem;
    }

    .form-card .card-header h5 {
        font-weight: 700;
        font-size: 1rem;
    }

    @media (max-width: 767.98px) {
        .form-card .card-body {
            padding: 1.25rem;
        }

        .form-actions {
            flex-direction: column-reverse;
        }

        .form-actions .btn {
            width: 100%;
        }
    }
</style>
{% endblock %}

{% block content %}
    <div class="row justify-content-center">
        <div class="col-md-9 col-lg-7">
            <div class="card form-card border-0 shadow-lg">
                <div class="card-header border-0 py-3">
                    <div class="d-flex align-items-center">
                        <span class="bg-white bg-opacity-20 p-2 rounded-3 me-3">
                            <i class="fas fa-box-open"></i>
                        </span>
                        <div>
                            <h5 class="mb-0 fw-800">{{ title }}</h5>
                            <p class="mb-0 small opacity-75">เพิ่มหรือแก้ไขรายละเอียดสินค้าและบริการที่มีค่าใช้จ่ายในโครงการนี้</p>
                        </div>
                    </div>
                </div>
                <div class="card-body p-4 p-md-5">
                    <form method="post" novalidate>
                        {% csrf_token %}
                        
                        <!-- Section 1: Item Details -->
                        <div class="mb-4 pb-2">
                            <div class="d-flex align-items-center mb-4 pb-2 border-bottom border-light">
                                <span class="bg-primary bg-opacity-10 text-primary p-2 rounded-circle me-3 d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="fas fa-info"></i>
                                </span>
                                <h6 class="mb-0 fw-bold text-dark">ข้อมูลรายการ</h6>
                            </div>
                            
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">ประเภทรายการ</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-light border-end-0"><i class="fas fa-layer-group text-muted"></i></span>
                                        {{ form.item_type }}
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">ชื่อรายการ <span class="text-danger">*</span></label>
                                    {{ form.name }}
                                </div>
                                <div class="col-12">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">รายละเอียด / สเปคสินค้า</label>
                                    {{ form.description }}
                                </div>
                                <div class="col-12">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">ซัพพลายเออร์ที่สั่งซื้อ</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-light border-end-0"><i class="fas fa-truck text-muted"></i></span>
                                        {{ form.supplier }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Section 2: Pricing & Quantity -->
                        <div class="mb-5">
                            <div class="d-flex align-items-center mb-4 pb-2 border-bottom border-light">
                                <span class="bg-success bg-opacity-10 text-success p-2 rounded-circle me-3 d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                    <i class="fas fa-calculator"></i>
                                </span>
                                <h6 class="mb-0 fw-bold text-dark">จำนวนและยอดเงิน</h6>
                            </div>
                            
                            <div class="row g-4">
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">จำนวนหน่วย</label>
                                    <div class="input-group">
                                        {{ form.quantity }}
                                        <span class="input-group-text bg-light border-start-0 text-muted small">Unit</span>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">ต้นทุน (บาท)</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-light border-end-0 text-muted fw-bold">฿</span>
                                        {{ form.unit_cost }}
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label fw-bold small text-muted text-uppercase letter-spacing-1">ราคาขาย (บาท)</label>
                                    <div class="input-group">
                                        <span class="input-group-text bg-light border-end-0 text-success fw-bold">฿</span>
                                        {{ form.unit_price }}
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex justify-content-end gap-3 pt-4 border-top form-actions">
                            <a href="{% url 'pms:project_detail' project.pk %}" class="btn btn-light px-4 py-2 border text-secondary fw-600 transition-all">
                                ยกเลิก
                            </a>
                            <button type="submit" class="btn btn-primary px-5 py-2 shadow-sm fw-700 transition-all">
                                <i class="fas fa-save me-2"></i>
                                {% if form.instance.pk %}บันทึกการแก้ไข{% else %}เพิ่มลงโครงการ{% endif %}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
